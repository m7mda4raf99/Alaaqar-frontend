<div class="alaqaar-blogs" [ngClass]="{'rtl' : activeLang.title === 'ar' || activeLang === 'ar'}">
    <ngx-spinner type="ball-scale-multiple" bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="rgba(0, 0, 0, 0.0)"   [fullScreen]="true">
        <img class="spinner-img" style='animation:flip-with-scale 3s infinite;position: relative;top:-100px;' src='../../assets/images/logo-loader.png'/>
        
    </ngx-spinner>
    <div class="row justify-content-center" style="margin: 25px 10px 0px 10px;">
        <div class="col-xs-12 col-sm-10" style="padding: 0px;">
            <div style="display:flex; margin: 0px;" class="breadcrumb">
                <div class="col-xs-12 bg-head">
                    <p class="main-title">{{'search.title' | translate}} <span>({{total_search_count}} {{'search.count' | translate}})</span></p>
                    <div class="head">
                        <p> <span style="color: #ABABB6;cursor: pointer;"> <span class="home-tab"
                                    [routerLink]="['/']">{{'blog.sub.Home' | translate}}</span></span>/ {{'search.title' |
                            translate}}</p>
                    </div>
                </div>
                
                <div class="buttons">
                    <div class="filter-button" (click)="changeFilter()">
                        <span> {{'Results.sub.Filters' | translate}} </span>
                        <fa-icon *ngIf="display != 'none'" style="position: initial;" [icon]="faChevronUp" class="faChevronUp"></fa-icon>
                        <fa-icon *ngIf="display === 'none'" style="position: initial;" [icon]="faChevronDown" class="faChevronDown"></fa-icon>
                    </div>
                    <div class="col-md-2" style="position: relative; margin: 0% 1%; width: 100%;">
                        
                        <select #dropdownFilter class="_filter" (change)="filterBy(dropdownFilter.value)"
                            class="form-select form-select-lg mb-3 float-end" aria-label=".form-select-lg example">
                            <option value="">{{'Results.sub.filter by' | translate}}</option>
                            <option value="DESC">{{'Results.sub.PriceLow' | translate}}</option>
                            <option value="ASC">{{'Results.sub.PriceHigh' | translate}}</option>
                        </select>
                        <fa-icon [icon]="faFilter" class="faFilter"></fa-icon>
                    </div>
                </div>

            </div>

            <div class="search-filters" [ngStyle]="{'display': display}" style="align-items: center;">
                <div  class="search-filters__box">
                    <div class="search-filters__filter search_input">
                        <ng-autocomplete #auto 
                            [data]="autoComplete"
                            [searchKeyword]="keyword"
                            placeholder="{{'buy.Placeholder' | translate}}"
                            (selected)='selectEvent($event)'
                            (inputCleared)='inputCleared()'
                            (selectedValueRender)='getHint()'
                            (inputChanged)='onChangeSearch($event)'
                            [itemTemplate]="itemTemplate"
                            [debounceTime]="200"
                            [focusFirst]="true"
                            [initialValue]="initialValue">                                 
                        </ng-autocomplete>

                        <ng-template #itemTemplate let-item>
                            <a [innerHTML]="item.name"></a>
                        </ng-template>
                    </div>

                    <div class="search-filters__filter estate_type">
                        <angular2-multiselect [data]="RealEstateType" [(ngModel)]="SelectedRealEstateType" 
                            [settings]="settingsUnitType" (onSelect)="Getsearch()">
                        </angular2-multiselect>
                    </div>
                    
                    <div class="search-filters__filter propose">
                        <angular2-multiselect [data]="dropdownListPropose" [(ngModel)]="selectedItemPropose"
                         [settings]="settingsPropose" (onSelect)="Getsearch()">
                        </angular2-multiselect>
                    </div>
                    
                    <!-- price range -->
                    <div class="ngSelect search-filters__filter priceRange">
                        <div class="dropdown" ngbDropdown>
                            <button ngbDropdownToggle [class.dimmed]="(!priceMinRange && !priceMaxRange)" #dropdownMenuButton1
                                class="btn dropdown-toggle setPriceBtn ngSelect-input"
                                type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                                {{setPricePlaceHolder()}}

                                <fa-icon style="position: initial; color: #aaaaaa; margin: 0px 10px;"  [icon]="faChevronDown"></fa-icon>

                            </button>
                            
                            <ul ngbDropdownMenu class="dropdown-menu" aria-labelledby="dropdownMenuButton1"
                                (click)="$event.stopPropagation()" style="overflow: visible; transform: translate3d(0px, 38.4px, 0px);">
                                
                                <!-- <app-price-range-slider (sender)="receiver($event)" [activeTab]="activeTab">
        
                                </app-price-range-slider> -->
                                
                                

                                <div id="price_range">
                                    <div id="Price_range_q">
                                        {{'home.Price range' | translate}}

                                        <button type="submit" (click)="searchPrice()" class="btn button-success"> 
                                            <fa-icon [icon]="faSearch"></fa-icon>
                                        </button>
                                    </div>
        
                                    <!-- <div id="slider">
                                        <ngx-slider [(value)]="minValue" [(highValue)]="maxValue" [options]="options"
                                        (valueChange)="userChangeMin(true)" (highValueChange)="userChangeMax(true)"></ngx-slider>
                                    </div> -->
        
                                    <div id="textboxes">
                
                                        <div id="from">
                                            {{activeLang === 'en' ? 'From' : 'من'}}
                
                                            <div id="fromTextbox">
                                        
                                                <input id="Rectangle_1314_rbk" [(ngModel)]="minValueInput" 
                                                placeholder="{{'home.Min Price' | translate}}"
                                                (keyup)="userChangeMin()" type="text" />
                                            </div>
                
                                        </div>
                                        
                                        <div id="to">
                                            {{activeLang === 'en' ? 'To' : 'إلى'}}
                                            
                                            <div id="fromTextbox">
                                        
                                                <input id="Rectangle_1314_rbk" [(ngModel)]="maxValueInput" 
                                                placeholder="{{'home.Max Price' | translate}}" type="text"
                                                (keyup)="userChangeMax()"/>
                                            </div>
                                        </div>
                                    
                                    </div>

                                </div>

                                
                                
                            </ul>
        
                        </div>
                        
                    </div>

                    <div class="search-filters__filter space">
                        <angular2-multiselect [data]="dropdownListSpace" [(ngModel)]="selectedItemSpace" 
                        [settings]="settingsSpace" (onSelect)="Getsearch()">
                        </angular2-multiselect>
                    </div>
                    
                    <div class="search-filters__filter rooms">
                        <angular2-multiselect [data]="dropdownListRoom" [(ngModel)]="selectedItemRoom" 
                        [settings]="settingsRoom" (onSelect)="Getsearch()">
                        </angular2-multiselect>
                        <!-- <ng-select [placeholder]="activeLang == 'ar' ? 'عدد الغرف' : 'Rooms count'" class="_filter" [(ngModel)]="bedroom">
                            <ng-option [value]="room.id" *ngFor="let room of bedroom_arr">{{activeLang == 'ar' ? room.name_ar : room.name_en}}</ng-option>
                          </ng-select> -->
                    </div>

                    <div *ngIf="activeTab != 'commercial'" class="ngSelect compound">

                        <div *ngIf="country_id === 1"> {{ 'home.Compound EGY' | translate }} </div>
                        <div *ngIf="country_id === 2 || country_id === 3"> {{ 'home.Compound KSA' | translate }} </div>

                        <ng-toggle style="margin: 0px 10px;" (change)="Getsearch()" [(value)]="in_compound" [color]="{unchecked: '#939da2', checked: '#184d47'}"> Compound </ng-toggle>
    
                    </div>
                
                </div>
                
                <button type="submit" (click)="clear()" class="btn button-success"> 
                    <fa-icon [icon]="faTrash"></fa-icon>
                    <span> {{'clear_button' | translate}} </span>
                </button>
               
            </div>
            
            <div class="results" *ngIf="results.length > 0">
                <div *ngFor="let item of results | paginate: { itemsPerPage: 18, currentPage: page,totalItems: total_search_count }" class="loop">
                    <div class="card">
                        <div style="position: relative;">
                            <span (click)="navigateToItemDetails(item)" class="overlay"></span>
                            <span style="cursor: pointer;" (click)="navigateToItemDetails(item)"
                                class="bage">{{getPropose(item)}}</span>
                            <img *ngIf="item['isFavorite']" (click)="toggleFavorite(item)" class="fav"
                                src="../../../../assets/images/Path 165 copy.png" alt="..." />
                            <img *ngIf="!item['isFavorite']" (click)="toggleFavorite(item)" class="fav"
                                src="../../../../assets/images/Path 165.png" alt="..." />
                            <img (click)="navigateToItemDetails(item)"
                            (auxclick)="openNewWindow($event, item)" src="{{setImagesSrc(item)}}" class="img-fluid" alt="...">
                        </div>
                        
                        <div class="card-body" style="cursor: pointer;" (click)="navigateToItemDetails(item)">  
                            <h6>
                                {{ item['title'] }}
                            </h6>

                            <h5 class="card-title">
                                <!-- <br> -->
                                {{ numberWithCommas(item['price'])}}

                                {{ getCurrency() }}
                            </h5>
                            
                            <div class="space-between">

                                <span class="location">
                                    <img src="../../../../assets/images/noun_Location_1911856@2x.png"
                                        alt="..." />
                                    {{activeLang === 'en' ? item['area_name_en'] : item['area_name_ar']}}
                                </span>


                                <span class="date">
                                    <img src="../../../../assets/images/date.png"
                                        alt="..." />
                                        {{ setDate(item['created_at']) }}
                                </span>

                            </div>
                                
                            <div class="card-text">
                                <div class="desc" *ngFor="let c of item['criteria'] | slice:0:4">
                                    <img class="img-icon" src="{{getCriteriaImageSrc(c)}}" alt=".." />
                                    {{getCriteriaOptions(c)}}
                                </div>
                            </div>

                            <div class="request-visit">
                                <button type="submit" (click)="requestVisit(sellerContent, item['unit_id'])"
                                    class="btn button-success">
                                    <span> {{'propertyDetails.Request a visit' | translate}} </span>
                                </button>
                            </div>
                            
                            <!-- <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p> -->
                        </div>
                        
                        
                    </div>
                </div>

                <pagination-controls style="width: 100%;" (pageChange)="onPageChange($event)" [(ngModel)]="page" ></pagination-controls>
            </div>
           
           
            <div *ngIf="results.length == 0 && isLoading">
                <div class="no-data">
                    <div class="no-data__icon">

                        <img src="../../assets/images/no-data.png"/>
                    </div>
                    <h4 style="color: #fd4965;margin:0;">{{'loading' | translate}}</h4>
                    <p>{{'loading_text' | translate}}</p>
                    
                </div>
            </div>

            <div *ngIf="results.length == 0 && !isLoading">
                <div class="no-data">
                    <div class="no-data__icon">

                        <img src="../../assets/images/no_results.png"/>
                    </div>
                    <h4 style="color: #fd4965;margin:0;">{{'no_results' | translate}}</h4>
                    <p>{{'no_results_text' | translate}}</p>
                    
                </div>
            </div>

        </div>
    </div>

    <ng-template #sellerContent let-c="close" let-d="dismiss">
        <div class="modal-header">
            <div style="width: 100%;">
                <img src="{{evaluator.avatar ? evaluator.avatar : '../../../../../../assets/images/default.png'}}"
                    alt="..." />
                <p>{{evaluator.name}}</p>
                <div class="raiting-model">
                    <ngb-rating [max]="5" [rate]="5">
                        <ng-template let-fill="fill" let-index="index">
                            <span class="star" [class.filled]="fill === 100">&#9733;</span>
                        </ng-template>
                    </ngb-rating>
                </div>
            </div>
        </div>
        <div class="modal-body">
            <p style="text-align: center;">
                {{'model.one of our agents will contact you' | translate}} <br><b
                    style="color: #FD4964;">{{evaluator.workingHours}}</b>
            </p>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-save" (click)="navigateToMyVisits()">{{'button.actions.Done' |
                translate}}</button>
        </div>
    </ng-template>
</div>

<!-- <div *ngIf="country_id === 3" class="coming-soon">
    <img src="../../assets/images/logo-header.svg"/>
    <h1>{{'coming_soon' | translate}}</h1>
</div> -->