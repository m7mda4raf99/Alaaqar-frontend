<ngx-spinner bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="rgba(0, 0, 0, 0.0)"   [fullScreen]="true">
    <img class="spinner-img" style='animation:flip-with-scale 3s infinite;position: relative;top:-100px;' src='../../assets/images/logo-loader.png'/>
  </ngx-spinner>
  
  <div #developersDiv class="electronic-advisor">
      <div class="container--fluid priorities-form">
          <div class="sub-head" >
            <div class="container-fluid">
              <div class="row justify-content-center container-fluid-again">
                <div class="col-xs-12 col-md-10 main-header">
                  <div *ngIf="stepper <= 0" class="bar"> 
                    <!-- title -->
                    <div class="section-head-center">
                      <h1>
                          <span class="top"></span>
                          {{'advisor.title' | translate}}
                          <span></span>
                      </h1>
                     
                    </div>

                    <!-- description -->
                    <h6> {{'advisor.description' | translate}} </h6>


                    <!-- buttons -->
                    <div class="button-holder">
                      <!-- (click)="addProject()"  -->
                      <button type="submit" class="btn back" (click)="back()"> {{'button.actions.Back to main search' | translate}} </button>

                      <button type="submit" class="btn" (click)="continue()"> {{'button.actions.Apply & Continue' | translate}} </button>
                    </div>

                  </div>
                  <p style="display: none;" class="sm-title"><span class="home-tab" [routerLink]="['/']">{{'sell.sub.Home' | translate}}</span> <span> / {{'header.Developers' | translate}}</span></p>
                </div>
              </div>
            </div>
          </div>
          <div class="container-fluid">
            <div class="row justify-content-center " style="background-color: #F7F7F7;">
              <div class="col-xs-12 col-md-10 main-content">
  
                <div class="property-details">
                  <div class="row" style="margin: 0px 15px;">
                      <div *ngIf="stepper > 0" class="main-row">
                          <div class="row details">

                              <!-- journey description -->
                              <span *ngIf="stepper >= 1" class="head-description"> {{'advisor.journey' | translate}} </span>

                              <!-- location -->
                              <div #location *ngIf="stepper == 1" class="location">
                                <span> {{'advisor.location' | translate}} </span>

                                <div class="dropdown">
                                  <angular2-multiselect class="each-dropdown"
                                      [data]="dropdownListCity" [(ngModel)]="selectedItemCity" 
                                      [settings]="settingsCity" (onSelect)="onChangeCity($event)"
                                      (onDeSelect)="onDeSelectAllCity()" (onDeSelectAll)="onDeSelectAllCity()">
                                  </angular2-multiselect>

                                  <angular2-multiselect *ngIf="dropdownListArea.length > 0" class="each-dropdown"
                                      [data]="dropdownListArea" [(ngModel)]="selectedItemArea" [settings]="settingsArea">
                                  </angular2-multiselect>

                                </div>

                                <div class="button-holder">              
                                  <button type="submit" class="btn" (click)="continue(location)"> {{'button.actions.Apply & Continue' | translate}} </button>
                                </div>
                              </div>

                              <!-- location preview -->
                              <div >
                                <div *ngIf="stepper > 1" class="location">

                                  <div class="title">
                                    {{'home.Location' | translate}} 
                                  </div>
  
                                  <div class="location_preview">
  
                                      <div class="location_card">
                                        {{lang === 'en' ? selectedItemCity[0].name_en : selectedItemCity[0].name_ar }}                                
                                      </div>
                                      <div class="location_card">
                                        {{lang === 'en' ? selectedItemArea[0].name_en : selectedItemArea[0].name_ar }}                                
    
                                      </div>
  
                                  </div>
  
                                </div>
                              </div>
                              
                              <!-- price -->
                              <div #price>
                                <div *ngIf="stepper == 2" class="price">
                                  <span> {{'advisor.price' | translate}} </span>
  
                                  <div class="inputs">
                                    <input class="each-input" [(ngModel)]="min_price" placeholder="{{'quest.Min Price' | translate}}"
                                    [allowNegative]="false" type="text" ngxNumberFormat="#,###,###,###" />    
  
                                    <input class="each-input" [(ngModel)]="max_price" placeholder="{{'quest.Max Price' | translate}}"
                                      [allowNegative]="false" type="text" ngxNumberFormat="#,###,###,###" />
                                  </div>
  
                                  <div class="button-holder">              
                                    <button type="submit" class="btn" (click)="continue(price)"> {{'button.actions.Apply & Continue' | translate}} </button>
                                  </div>
                                </div>
                              </div>

                              <!-- price preview -->
                              <div *ngIf="stepper > 2" class="price">

                                <div class="title">
                                  {{'home.Price range' | translate}} 
                                </div>

                                <div class="price_preview">
                                  <div class="price_card">
                                    {{ abbreviateNumber(min_price) }}                       
                                  </div>

                                  ~

                                  <div class="price_card">
                                    {{ abbreviateNumber(max_price) }}                       
                                  </div>

                                </div>

                              </div>
                              
                              <!-- priority description -->
                              <div #priority_description style="display: flex; flex-direction: column; align-items: center;">
                                <span *ngIf="stepper == 3" class="head-description"> {{'advisor.priority_description' | translate}} </span>
                                <div *ngIf="stepper == 3" class="button-holder">              
                                  <button type="submit" class="btn" (click)="continue(choose_top_priority)"> {{'button.actions.Apply & Continue' | translate}} </button>
                                </div>
                              </div>

                              <!-- choose_top_priority -->
                              <div #choose_top_priority style="display: flex; flex-direction: column; align-items: center;">
                                <span *ngIf="stepper == 4" class="head-description"> {{'advisor.choose_top_priority' | translate}} </span>
                                
                                <!-- high priorites -->
                                <div *ngIf="stepper == 4" class="priorites-list" style="width: 100%;"> 
                                  <div class="main">
                                    <div class="row margin_all">
                                      <!-- [class.selected]="item.selected === true" -->
                                      <div class="mt-3 custom-element" *ngFor="let item of getCriterias(1)">
                                          
                                          <div class="box notClicked" (click)="selectItem(item)" *ngIf='item.selectedPriority != 1'>
                                              <div class="insert">
                                                  <!-- <fa-icon [icon]="faCheckSquare"></fa-icon> -->
                                                  <img class="toggle" src="../../../../assets/images/not_checked.png" alt="..." />
                                              </div>
                                              
                                              <span class="icon">
                                                  <!-- *ngIf='item.selected === false' -->
                                                  <img  src="{{baseUrl + item.icon}}" alt="..."/>
                                              </span>
                                              <span class="text">
                                                  {{lang === 'en' ?  item.name_en :  item.name_ar}}
                                              </span>
                                          </div>

                                          <div class="box clicked" (click)="deSelectItem(item)" *ngIf='item.selectedPriority === 1'>
                                              <div class="delete">
                                                  <img class="toggle" src="../../../../assets/images/checked.png" alt="..." />
                                              </div>

                                              <span class="icon">
                                                  <img  src="{{baseUrl + item.icon}}" alt="..."/>
                                              </span>
                                              <span class="text">
                                                  {{ lang === 'en' ? item.name_en : item.name_ar}}
                                              </span>
                                          </div>
                                      </div>

                                    </div>
                                  </div>
                                </div>

                                <div *ngIf="stepper == 4" class="button-holder">              
                                  <button type="submit" class="btn" (click)="continue(price)"> {{'button.actions.Apply & Continue' | translate}} </button>
                                </div> 
                              </div> 

                              <!-- set_top_priority -->
                              <div #set_top_priority style="display: flex; flex-direction: column; align-items: center;">
                                <span *ngIf="stepper == 5" class="head-description"> {{'advisor.set_top_priority' | translate}} </span>

                                <div *ngIf="stepper == 5" class="priorites-list" style="width: 100%;"> 
                                  <div class="main">
                                    <div class="margin_all">
                                      <!-- {{ scroll(mid) }} -->

                                      

                                      <div class="form-stepper" [ngStyle]="{'pointer-events': stepper > 5 ? 'none': 'initial' }">
                                        <div *ngIf="stepper > 5" class="title">
                                          Top priorities
                                        </div>

                                        <form [formGroup]="stepForm" autocomplete="off" novalidate #formRef="ngForm">

                                          <div class="margin_item" *ngFor="let ctrl of stepForm.controls | keyvalue;let index = index;">
                                     
                                            <div class="box preview">
                                              <span class="icon">
                                                  <img  src="{{ getImageSrc(ctrl.key,formData) }}" alt="..."/>
                                              </span>
                                              <span class="text">
                                                {{getKeyName(ctrl.key, formData)}}
                                              </span>
                                            </div>

                                            <div class="row">
                                                <ng-container
                                                    [ngTemplateOutlet]="multiSelectCheckbox"
                                                    [ngTemplateOutletContext]="{key: index}">
                                                </ng-container>
                                            </div>
                                            
                                            <ng-template #multiSelectCheckbox let-key="key">
                                                <div class="col-6"
                                                    *ngFor="let sValue of util.getFilteredValues(ctrl.key,formData);let i = index;">
                                                    <input (change)="setupFormControlValue($event,ctrl.key, sValue)" mdbCheckbox type="checkbox"
                                                        class="btn-check" [id]="ctrl.key + i" autocomplete="off" />
                                                    <label [class.filled]="checkIsSelected(ctrl.key, sValue) !== -1" class="btn btn-primary"
                                                        [for]="ctrl.key + i">
                                                        {{lang === 'en' ? sValue.name_en : sValue.name_ar}}
                                                        <span *ngIf="checkIsSelected(ctrl.key, sValue) !== -1">{{'buy.Option' | translate}}
                                                            {{checkIsSelected(ctrl.key,
                                                            sValue)+1}}</span>
                                                    </label>
                                                </div>
                                            </ng-template>
                                          </div>
                                                
                                        </form>
                                        
                                      </div>
                                    </div>
    
                            
                                  </div>
                                </div>

                                <div *ngIf="stepper == 5" class="button-holder">              
                                  <button type="submit" class="btn" (click)="continue(choose_low_priority)"> {{'button.actions.Apply & Continue' | translate}} </button>
                                </div> 
                              </div>

                              <!-- choose_low_priority -->
                              <div #choose_low_priority style="display: flex; flex-direction: column; align-items: center;">
                                <span *ngIf="stepper == 6" class="head-description"> {{'advisor.choose_low_priority' | translate}} </span>
                                
                                <!-- low priorites -->
                                <div *ngIf="stepper == 6" class="priorites-list" style="width: 100%;"> 
                                  <div class="main">
                                    <div class="row margin_all">
                                      <!-- [class.selected]="item.selected === true" -->
                                      <div class="mt-3 custom-element" *ngFor="let item of getCriterias(2)">
                                          
                                          <div class="box notClicked" (click)="selectItem(item)" *ngIf='item.selectedPriority != 2'>
                                              <div class="insert">
                                                  <!-- <fa-icon [icon]="faCheckSquare"></fa-icon> -->
                                                  <img class="toggle" src="../../../../assets/images/not_checked.png" alt="..." />
                                              </div>
                                              
                                              <span class="icon">
                                                  <!-- *ngIf='item.selected === false' -->
                                                  <img  src="{{baseUrl + item.icon}}" alt="..."/>
                                              </span>
                                              <span class="text">
                                                  {{lang === 'en' ?  item.name_en :  item.name_ar}}
                                              </span>
                                          </div>

                                          <div class="box clicked" (click)="deSelectItem(item)" *ngIf='item.selectedPriority === 2'>
                                              <div class="delete">
                                                  <img class="toggle" src="../../../../assets/images/checked.png" alt="..." />
                                              </div>

                                              <span class="icon">
                                                  <img  src="{{baseUrl + item.icon}}" alt="..."/>
                                              </span>
                                              <span class="text">
                                                  {{ lang === 'en' ? item.name_en : item.name_ar}}
                                              </span>
                                          </div>
                                      </div>

                                    </div>
                                  </div>
                                </div>

                                <div *ngIf="stepper == 6" class="button-holder">              
                                  <button type="submit" class="btn" (click)="continue(price)"> {{'button.actions.Apply & Continue' | translate}} </button>
                                </div> 
                              </div> 

                              <!-- set_low_priority -->
                              <div #set_low_priority style="display: flex; flex-direction: column; align-items: center;">
                                <span *ngIf="stepper == 7" class="head-description"> {{'advisor.set_low_priority' | translate}} </span>

                                <div *ngIf="stepper == 7" class="priorites-list" style="width: 100%;"> 
                                  <div class="main">
                                    <div class="margin_all">
                                      <!-- {{ scroll(mid) }} -->
                                      <div class="form-stepper">
                                        <form [formGroup]="stepForm" autocomplete="off" novalidate #formRef="ngForm">
                                          <div class="margin_item" *ngFor="let ctrl of stepForm.controls | keyvalue;let index = index;">
                                     
                                            <div class="box preview">
                                              <span class="icon">
                                                  <img  src="{{ getImageSrc(ctrl.key,formData) }}" alt="..."/>
                                              </span>
                                              <span class="text">
                                                {{getKeyName(ctrl.key, formData)}}
                                              </span>
                                            </div>

                                            <div class="row">
                                                <ng-container
                                                    [ngTemplateOutlet]="multiSelectCheckbox"
                                                    [ngTemplateOutletContext]="{key: index}">
                                                </ng-container>
                                            </div>
                                            
                                            <ng-template #multiSelectCheckbox let-key="key">
                                                <div class="col-6"
                                                    *ngFor="let sValue of util.getFilteredValues(ctrl.key,formData);let i = index;">
                                                    <input (change)="setupFormControlValue($event,ctrl.key, sValue)" mdbCheckbox type="checkbox"
                                                        class="btn-check" [id]="ctrl.key + i" autocomplete="off" />
                                                    <label [class.filled]="checkIsSelected(ctrl.key, sValue) !== -1" class="btn btn-primary"
                                                        [for]="ctrl.key + i">
                                                        {{lang === 'en' ? sValue.name_en : sValue.name_ar}}
                                                        <span *ngIf="checkIsSelected(ctrl.key, sValue) !== -1">{{'buy.Option' | translate}}
                                                            {{checkIsSelected(ctrl.key,
                                                            sValue)+1}}</span>
                                                    </label>
                                                </div>
                                            </ng-template>
                                          </div>
                                                
                                        </form>
                                        
                                      </div>
                                    </div>
    
                            
                                  </div>
                                </div>

                                <div *ngIf="stepper == 7" class="button-holder">              
                                  <button type="submit" class="btn" (click)="continue(choose_low_priority)"> {{'setupBuyerPriorities.Show Results' | translate}} </button>
                                </div> 
                              </div>

                          </div>
                      </div>
                  </div>

                </div>
                      
              </div>
            </div>
          </div>
      </div>
  </div>
